\chapter{Dienstebenen}
\label{sec:Dienstebenen}
Die Dienstebenen beschreiben unterschiedliche Qualitäten der Informationskopplung, die im Folgenden weiter erläutert werden und aufeinander aufbauen. Um eine Kopplung zwischen FVS und RIS zu realisieren, muss mindestens die Dienstebene 0 zum Austausch der Stations- und Betreiberinformationen von beiden Interaktionspartnern unterstützt werden. Das Ebenen-Modell ist streng hierarchisch aufgebaut, somit setzt jede Dienstebene die Realisierung und Verwendung aller vorhergehenden Ebenen voraus.

\interactiongraphics{levelRIS-CS}
 
\section{Ebene 0 -- Stationsinformationen}
Die Dienstebene 0 dient der Initialisierung der Informationskopplung und bietet Funktionen, um eine gemeinsame Festlegung der zu verwendenden Dienstebene zwischen den Interaktionspartnern (RIS und FVS) zu ermöglichen und die Stations- und Betreiberinformationen vom FVS zum RIS zu übertragen. 

Dienstebene 0 kann beispielsweise dafür verwendet werden, um nur Hinweise zu vorhandenen Stationen eines FVS-Betreibers in einem RIS anzuzeigen.
\subsection*{Funktionen}
\begin{itemize}
\item Aushandlung der zu verwendenden Protokollversion und Dienstebene
\item Abruf der Stations- und Betreiberinformationen
\end{itemize}

\section{Ebene 1 -- Verfügbarkeitsauskunft}
Die Dienstebene 1 dient der Übermittelung von Informationen über die Verfügbarkeit von Fahrzeugen vom FVS zum RIS.

Die Verfügbarkeitsinformationen können vom RIS abonniert werden. Diese werden daraufhin durch das FVS in Form von Buchungszielen bereitgestellt und bei Änderungen aktualisiert. Buchungsziele stellen nur eine informative (unverbindliche) Verfügbarkeit von Fahrzeugen dar, da dabei nicht sichergestellt wird, dass ein Fahrzeug real zur Verfügung steht. Es wird dabei nur die Möglichkeit einer Verfügbarkeit dargestellt. Die genaue Verfügbarkeit kann vom RIS beim FVS durch eine zusätzliche Anfrage ermittelt werden. Das RIS darf davon ausgehen, dass in Abwesenheit eines Buchungsziels keine entsprechenden Fahrzeuge zur Verfügung stehen, so dass keine unnötigen Verfügbarkeitsanfragen an das FVS gestellt werden.

\subsection*{Funktionen}
\begin{itemize}
\item Abrufen und Aktualisierung der Buchungsziele
\item Abfrage von Fahrzeugverfügbarkeiten
\end{itemize}

\section{Ebene 2 -- Tarifauskunft}
Die Dienstebene 2 dient der Übermittlung von Informationen über die Tarife und Preise für die Miete von Fahrzeugen der FV-Betreiber.

Tarifinformationen können vom RIS beim FVS abgerufen werden. Dienstebene 2 erweitert die Buchungsziele aus Dienstebene 1 um Referenzen auf die anwendbaren Tarife. Die Tarife führen nicht zu einer verbindlichen Preisauskunft, sondern dienen nur zu einer Abschätzung der dem Nutzer für eine Miete entstehenden Kosten. Eine genaue Preisauskunft kann vom RIS beim FVS durch eine zusätzliche Anfrage ermittelt werden.

\subsection*{Funktionen}
\begin{itemize}
\item Abrufen der Tarifinformationen
\item Anfrage eines Preises
\end{itemize}

\section{Ebene 3 -- Buchung}
Die Dienstebene 3 dient zur Durchführung von Buchungen von Fahrzeugen durch das RIS im Auftrag eines Kunden des FVS.

Für die Buchung eines Fahrzeuges ist es notwendig, dass der Kunde sich gegenüber dem FVS authentifiziert. Dazu werden die Authentifizierungsinformationen vom RIS an das FVS weitergeleitet. Das Geheimnis (Passwort, PIN, etc.) des Kunden darf vom RIS aus Sicherheitsgründen nicht gespeichert werden. Das RIS erhält bei erfolgreicher Authentifizierung eines Kunden für diesen ein Authentifizierungs-Token. Dieser kann entweder im RIS oder auf dem Endgerät des Kunden gespeichert werden. Unter Verwendung des Authentifizierungs-Tokens kann das RIS Anfragen zur Buchung und Stornierung von Buchungen durchführen. Das RIS kann Informationen zu einer Buchung abonnieren. Daraufhin werden durch das FVS die Buchungsinformationen bei Änderungen aktualisiert. Buchungen, die durch das RIS gebucht wurden, müssen durch das RIS abonniert und storniert werden können.

\subsection*{Funktionen}
\begin{itemize}
\item Authentifizierung von Nutzern gegenüber dem FVS.
\item Anfrage zur Buchung
\item Anfrage zur Stornierung
\item Kontinuierliche Aktualisierung der Buchungen
\end{itemize}

\section{Ebene 4 -- Umbuchung}
Die Dienstebene 4 dient zur Durchführungen von Buchungsänderungen durch das RIS im Auftrag eines Kunden des FVS.

Um den Nutzer zu ermöglichen eine Buchung zu ändern kann eine Buchung durch eine Umbuchungsanfrage des RIS durch eine neue Buchung ersetzt werden. Dabei muss sichergestellt werden, dass im Fall, dass keine neue Buchung möglich ist, die alte Buchung ihre Gültigkeit behält.

\subsection*{Funktionen}
\begin{itemize}
\item Anfrage zur Umbuchung
\end{itemize}